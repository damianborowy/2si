{% extends "factory/base.html" %}

{% block content %}
    <h1>Contribute BOS</h1>

    {% for category in categories %}
        <button onclick="handleCategoryChange({{ category.id }})">{{ category.name }}</button>
    {% endfor %}

    <form class="form" action="" method="post">
        <input type="hidden" name="positive" value="{{ positive }}">
        <input type="hidden" name="action_type" value="{{ action_type }}">
        <input type="hidden" name="worker_id" value="{{ worker_id }}">
        {% if action_type == "B" %}
            <input type="hidden" name="location_id" value="{{ location_id }}">
        {% endif %}
        {% csrf_token %}
        <div id="categories">
            {% for category in categories %}
                <div id="{{ category.id }}">
                    {% for rule in category.rule_set.all %}
                        <input class="form-check-input" name="rule" type="checkbox" value="{{ rule.id }}"
                               id="{{ rule.id }}">
                        <label class="form-check-label" for="{{ rule.id }}">{{ rule }}</label>
                    {% endfor %}
                </div>
            {% endfor %}
        </div>
        <button class="btn btn-primary mb-2" type="submit">Submit</button>
    </form>

    <script>
        function handleCategoryChange(newCat) {
            const categories = document.getElementById("categories");

            for (let category of categories.children)
                category.style.display = category.id == newCat ? "block" : "none";
        }

        handleCategoryChange({{ categories.0.id }});
    </script>
{% endblock %}